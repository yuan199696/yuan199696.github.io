<!-- build time:Sun Feb 20 2022 21:34:44 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://baiyezi.vip/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://baiyezi.vip/atom.xml"><link rel="alternate" type="application/json" href="https://baiyezi.vip/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Java,JVM"><link rel="canonical" href="https://baiyezi.vip/java/JVM/JVM-GC/"><title>JVM-GC - Java |</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">JVM-GC</h1><div class="meta"><span class="item" title="创建时间：2021-07-05 21:30:04"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-07-05T21:30:04+08:00">2021-07-05</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>6.4k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>6 分钟</span> </span><span id="java/JVM/JVM-GC/" class="item leancloud_visitors" data-flag-title="" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start"></a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://gitee.com/bfanfanfan/img/raw/master/guzhuang/20211225105423.jpg"></li><li class="item" data-background-image="https://gitee.com/bfanfanfan/img/raw/master/yangchenglin/20220220211854.png"></li><li class="item" data-background-image="https://gitee.com/bfanfanfan/img/raw/master/guzhuang/20211225105418.jpg"></li><li class="item" data-background-image="https://gitee.com/bfanfanfan/img/raw/master/guzhuang/20211225104957.png"></li><li class="item" data-background-image="https://gitee.com/bfanfanfan/img/raw/master/guzhuang/20211225105422.jpg"></li><li class="item" data-background-image="https://gitee.com/bfanfanfan/img/raw/master/guzhuang/20211225105421.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/java/" itemprop="item" rel="index" title="分类于 Java"><span itemprop="name">Java</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://baiyezi.vip/java/JVM/JVM-GC/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="fanfanfan"><meta itemprop="description" content=", 花有重开日，人无再少年"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><h2 id="garbage-collector"><a class="anchor" href="#garbage-collector">#</a> Garbage Collector</h2><p>JVM 中的垃圾是指：没有任何引用指向的对象，JVM 会自动对这些对象自进行回收，从而达到清理内存的效果</p><h2 id="jvm寻找垃圾"><a class="anchor" href="#jvm寻找垃圾">#</a> JVM 寻找垃圾</h2><h3 id="引用计数算法reference-count"><a class="anchor" href="#引用计数算法reference-count">#</a> 引用计数算法（reference count）</h3><p>当有引用指向对象时，那么指向该对象的计数就加 1，当计数为 0 时就代表没有引用指向该对象，那么该对象就是可回收的垃圾对象。</p><p>这种算法无法解决循坏引用对象变为垃圾时的回收，此时需要根可达算法来解决</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210308183607659.png" alt="image-20210308183607659"></p><h3 id="根可达性算法root-searching"><a class="anchor" href="#根可达性算法root-searching">#</a> 根可达性算法（Root Searching）</h3><p>与根对象无关的对象就是垃圾对象</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210308183116456.png" alt="image-20210308183116456"></p><p>哪些是根对象？</p><p>线程栈变量：main 方法中的变量</p><p>常量池：常量池中的类引用其他类的对象</p><p>JNI 指针：C 或 C++ 写的本地方法中的类或对象</p><p>根对象的特点就是当程序启动后立即加载的对象</p><h2 id="gc常用清除垃圾算法"><a class="anchor" href="#gc常用清除垃圾算法">#</a> GC 常用清除垃圾算法</h2><h3 id="标记清除算法mark-sweep"><a class="anchor" href="#标记清除算法mark-sweep">#</a> 标记清除算法（Mark-Sweep）</h3><p>找到垃圾对象后进行标记清除，存活对象比较多的情况下效率较高。算法上看是经过了两边扫描，效率偏低，一遍扫描用于标记不可回收的对象（GC Roots 可达的对象标记为存活的对象），第二遍扫描用于清除可回收的对象，标记清除之后会产生大量不连续的内存碎片，空间碎片太多可能会导致，碎片过多会导致大对象无法分配到足够的连续内存，从而不得不提前触发 GC，甚至 Stop The World。</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210308185946936.png" alt="image-20210308185946936"></p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210308190941445.png" alt="image-20210308190941445"></p><h3 id="拷贝算法copying"><a class="anchor" href="#拷贝算法copying">#</a> 拷贝算法（Copying）</h3><p>将内存一分为二，每次只使用其中一块内存，当其中一块内存快用完的时候，就将存活的对象复制到另外一块内存（对象的引用也将发生变化），然后清理使用过的那一块内存，这样不会有内存碎片，适合存活对象较少（适合 Eden 区）的情况。缺点是浪费空间。</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210308192400614.png" alt="image-20210308192400614"></p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/20210308203944.png" alt="image-20210308203932923"></p><h3 id="标记压缩算法mark-compact"><a class="anchor" href="#标记压缩算法mark-compact">#</a> 标记压缩算法（Mark-Compact）</h3><p>标记存活的对象，并将存活的对象移动到一端后压缩到一块连续的内存（所以不会产生内存碎片），然后直接清除端边界以外的内存中可回收的对象，效率偏低（两遍扫描，指针需要调整）</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/20210308204841.png" alt="image-20210308204441966"></p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/20210308204923.png" alt="image-20210308204827254"></p><h2 id="分代算法"><a class="anchor" href="#分代算法">#</a> 分代算法</h2><p>并不是所有的垃圾回收器都是分代的，除 Epsilon、ZGC、Shenandoah 之外的 GC 都是使用逻辑分代模型</p><p>G1 是逻辑分代，物理不分代，除此之外的 GC 不仅逻辑分代而且物理分代（内存上分区）</p><h3 id="堆内逻辑分区"><a class="anchor" href="#堆内逻辑分区">#</a> 堆内逻辑分区</h3><p>不适用于不分代垃圾收集器</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309113728879.png" alt="image-20210309113728879"></p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309094353933.png" alt="image-20210309094353933"></p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309094628428.png" alt="image-20210309094628428"></p><h3 id="新生代young"><a class="anchor" href="#新生代young">#</a> 新生代（young）</h3><p>新创建的对象如果无法在栈中分配，那么就会分配给新生代区，新生代分为 Eden 区和两个 survivor 区（s1 和 s2，用于存放 GC 后的对象），默认比例是 8：1：1。当新生代内存耗尽时就会触发新生代中的垃圾回收，称之为 MinorGC/YGC。对于新生代来说，GC 算法中复制算法最为合适，因为新生代 GC 后存活对象比较少，复制对象的成本较低。</p><ol><li>YGC 回收之后，Eden 大多数的对象会被回收，活着的进入 s0</li><li>再次 YGC，活着的对象 eden + s0 -&gt; s1</li><li>再次 YGC，eden + s1 -&gt; s0</li><li>年龄足够 -&gt; 老年代 （15 CMS 6）</li><li>s 区装不下 -&gt; 老年代</li></ol><h3 id="老年代old"><a class="anchor" href="#老年代old">#</a> 老年代（old）</h3><p>当新生代中的对象在 survivor 区存活一定的年龄时就会进入老年代区，当老年代无法继续分配空间时就会触发对于老年代的空间回收，称之为 MajorGC/FullGC。对于老年代来说，GC 算法中标记清除或标记压缩算法均适用。</p><ol><li>顽固分子</li><li>老年代满了 FGC，即 Full GC</li></ol><h3 id="永久代方法区"><a class="anchor" href="#永久代方法区">#</a> 永久代（方法区）</h3><ol><li>永久代 元数据 - Class</li><li>永久代必须指定大小限制 （不会动态扩容，可能发生内存溢出），元数据可以设置，也可以不设置，无上限（受限于物理内存）</li><li>字符串常量 1.7 - 永久代，1.8 - 堆</li><li>MethodArea（方法区）逻辑概念 - 永久代、元数据</li></ol><h3 id="对象何时进入老年代"><a class="anchor" href="#对象何时进入老年代">#</a> 对象何时进入老年代</h3><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309111544062.png" alt="image-20210309111544062"></p><ul><li>动态年龄：当新生代 GC（YGC）后，Eden 区和 S1 区存活的对象会被存放到 S2 区，当这些对象（不同年龄）大小超过 S2 区的一半大小时，对象中年龄大的就会直接进入老年区 <span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC85ODlkM2IwNmE0OWQ=">参考</span></li><li>超过 XX:MaxTenuringThreshold 指定的次数（YGC 后对象的年龄）时，对象就会进入老年代。不同垃圾器的分代年龄不同</li></ul><h3 id="分配担保"><a class="anchor" href="#分配担保">#</a> 分配担保</h3><p>YGC 期间，如果有新的对象被分配，且 survivor 区空间不够的情况下，此时就会通过空间担保让对象直接进入老年代</p><p><span class="exturl" data-url="aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xMDgyNzMw">参考</span></p><h3 id="栈上分配对象"><a class="anchor" href="#栈上分配对象">#</a> 栈上分配对象</h3><ul><li><p>线程本地分配 TLAB（Thread Local Allocation Buffer）：每个线程占有 Eden 区的 1% 的空间，线程优先在各自持有的 1% 的空间上分配对象，这样就不会与其他线程争用空间的现象，提高了效率。JVM 调优时一般无需对该空间做调整。</p></li><li><p>栈上分配：如果是线程私有的小对象（且该对象只在某一块代码中使用，不会被引用（包括不会被自身类的对象引用）），那么优先在栈上分配。JVM 调优时一般无需对该空间做调整。栈上分配的效率比堆上分配的效率要高，且栈上分配不涉及 GC，只需要将对象 pop 即可</p></li></ul><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309103441419.png" alt="image-20210309103441419"></p><p>无逃逸：指的是对象只在某一块代码中使用，不会以任何形式被引用</p><p>支持标量替换：可以用对象中的基本类型的属性代替整个对象</p><p>以下做一个测试：分别关闭打开栈上分配以及 TLAB 时程序执行的效率</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>fan<span class="token punctuation">.</span>gc</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/**</span></pre></td></tr><tr><td data-num="4"></td><td><pre> * @Author: fan</pre></td></tr><tr><td data-num="5"></td><td><pre> * @DateTime: 2021-03-09 10:35</pre></td></tr><tr><td data-num="6"></td><td><pre> **/</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// 测试时需要给 JVM 加上以下参数（关闭栈上分配和线程本地分配，默认是开启的）</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// 去掉逃逸分析             去掉标量替换               去掉 TLAB</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">//-XX:-DoEscapeAnalysis -XX:-EliminateAllocations -XX:-UseTLAB</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// 逃逸分析 标量替换 线程专有对象分配</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestTLAB</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token comment">//User u;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">int</span> id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token class-name">String</span> name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"name "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">//        u = new User (i, "name" + i); // 这样写就代表有逃逸</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token class-name">TestTLAB</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestTLAB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">1000_0000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> t<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token comment">//for(;;);</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>未关闭栈上分配以及 TLAB 时，程序执行时间为 400ms 左右。</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309110819631.png" alt="image-20210309110819631"></p><p>现在关闭栈上分配以及 TLAB：</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309110557258.png" alt="image-20210309110557258"></p><p>关闭栈上分配以及 TLAB 时，程序执行的时间为 900ms 左右</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309110731337.png" alt="image-20210309110731337"></p><h2 id="对象被分配的位置"><a class="anchor" href="#对象被分配的位置">#</a> 对象被分配的位置</h2><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309113328218.png" alt="image-20210309113328218"></p><h2 id="常见的垃圾回收器"><a class="anchor" href="#常见的垃圾回收器">#</a> 常见的垃圾回收器</h2><p>JDK1.8 默认的垃圾回收：Parallel Scavenge + Parallel Old</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309134247791.png" alt="image-20210309134247791"></p><ol><li>JDK 诞生后，第一个垃圾回收器就是 Serial，Serial 是单线程的，只能穿行回收，为了提高效率，诞生了 PS（Parallel Scavenge），为了配合 CMS，诞生了 PN（Parallel New），CMS 是 JDK1.4 版本后期引入，CMS 是里程碑式的 GC，它开启了并发回收的过程，但是 CMS 毛病较多，因此目前没有任何一个 JDK 版本默认是 CMS。并发垃圾回收是因为无法忍受 STW。</li><li>Serial 年轻代 串行回收</li><li>PS 年轻代 并行回收</li><li>ParNew 年轻代 配合 CMS 的并行回收</li><li>SerialOld</li><li>ParallelOld</li><li>ConcurrentMarkSweep 老年代 并发的， 垃圾回收和应用程序同时运行，降低 STW 的时间 (200ms)<br>CMS 问题比较多，所以现在没有一个版本默认是 CMS，只能手工指定<br>CMS 既然是 MarkSweep，就一定会有碎片化的问题，碎片到达一定程度，CMS 的老年代分配对象分配不下的时候，使用 SerialOld 进行老年代回收<br>想象一下：<br>PS + PO -&gt; 加内存 换垃圾回收器 -&gt; PN + CMS + SerialOld（几个小时 - 几天的 STW）<br>几十个 G 的内存，单线程回收 -&gt; G1 + FGC 几十个 G -&gt; 上 T 内存的服务器 ZGC<br>算法：三色标记 + Incremental Update</li><li>G1(10ms)<br>算法：三色标记 + SATB</li><li>ZGC (1ms) PK C++<br>算法：ColoredPointers + LoadBarrier</li><li>Shenandoah<br>算法：ColoredPointers + WriteBarrier</li><li>Eplison</li><li>PS 和 PN 区别的延伸阅读：<br>▪<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vZW4vamF2YS9qYXZhc2UvMTMvZ2N0dW5pbmcvZXJnb25vbWljcy5odG1s">https://docs.oracle.com/en/java/javase/13/gctuning/ergonomics.html#GUID-3D0BB91E-9BFF-4EBB-B523-14493A860E73</span></li><li>垃圾收集器跟内存大小的关系<ol><li>Serial 几十兆</li><li>PS 上百兆 - 几个 G</li><li>CMS - 20G</li><li>G1 - 上百 G</li><li>ZGC - 4T - 16T（JDK13）</li></ol></li></ol><p><strong>具体解释：</strong></p><p>目前所有垃圾回收器都有一个问题（除了 CMS 之外）：在垃圾回收时会停止当前的工作线程，即 stop the world（STW），垃圾清除完成之后再继续工作</p><h3 id="serial"><a class="anchor" href="#serial">#</a> Serial</h3><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309134907226.png" alt="image-20210309134907226"></p><p>是一个单线程的垃圾回收器，采用了复制算法，用在新生代区的垃圾回收。当清理垃圾时，会找到一个安全点来停止当前所有的工作，等待垃圾清理完成后继续从安全点开始工作，</p><h3 id="serial-old"><a class="anchor" href="#serial-old">#</a> Serial Old</h3><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309140524983.png" alt="image-20210309140524983"></p><p>单线程的垃圾回收器，采用了标记清除 / 标记压缩算法，用于老年区的垃圾回收。</p><h3 id="paraller-scavenge"><a class="anchor" href="#paraller-scavenge">#</a> Paraller Scavenge</h3><p>并行清除（注意并行与并发的区分），即多个线程同时清除垃圾</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309141237986.png" alt="image-20210309141237986"></p><p>多线程的垃圾回收器，采用了复制算法，用于新生代区的垃圾回收</p><h3 id="parallel-old"><a class="anchor" href="#parallel-old">#</a> Parallel Old</h3><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309142159515.png" alt="image-20210309142159515"></p><p>多线程的垃圾回收器，采用了整理（压缩）算法，用于老年代区的垃圾回收</p><h3 id="parnewparallel-new"><a class="anchor" href="#parnewparallel-new">#</a> ParNew（Parallel New）</h3><p>Parallel Scavenge 的新版本，做了一些增强，以便能与 CMS 配合使用</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309142939221.png" alt="image-20210309142939221"></p><p>多线程的垃圾回收器，采用复制算法，用于新生代区的垃圾回收</p><h3 id="cmsconcurrent-mark-sweep"><a class="anchor" href="#cmsconcurrent-mark-sweep">#</a> CMS(Concurrent Mark Sweep)</h3><p>CMS 是一个老年代区的垃圾回收器，是并发标记清理垃圾的，即回收垃圾时不需要停止所有的工作线程（STW），回收线程与工作线程并发执行</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309161623666.png" alt="image-20210309161623666"></p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309162641292.png" alt="image-20210309162641292"></p><p>以上蓝色箭头代表工作线程，黄色箭头代表 gc 线程</p><ul><li><p>初始标记：标记根对象，此时会 STW</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309165607661.png" alt="image-20210309165607661"></p></li><li><p>并发标记：标记与跟对象相关的对象。gc 的 80% 的时间都浪费在并发标记阶段，所以并发标记的同时可以让工作线程也一起工作</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309165635223.png" alt="image-20210309165635223"></p></li><li><p>重新标记：由于在并发标记的同时，工作线程也在工作，所以工作线程在并发标记的同时会产生一些垃圾对象，此时，就需要重新标记新产生的对象，这个过程会有 STW</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309165800289.png" alt="image-20210309165800289"></p></li><li><p>并发清理：清理垃圾对象的线程与工作线程同时执行，而这个过程也会产生新的垃圾对象，这些垃圾成为浮动垃圾，等待 CMS 下次开始运行后清除这些浮动垃圾</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210309165842240.png" alt="image-20210309165842240"></p></li></ul><p><a href="%5Bhttps://docs.oracle.com/en/java/javase/13/gctuning/ergonomics.html#GUID-3D0BB91E-9BFF-4EBB-B523-14493A860E73%5D(https://docs.oracle.com/en/java/javase/13/gctuning/ergonomics.html)">PS 和 PN 区别</a></p><h3 id="g110ms"><a class="anchor" href="#g110ms">#</a> G1（10ms）</h3><p>G1 是 JDK1.7 开始的但不稳定，JDK1.9 默认垃圾回收器为 G1。逻辑分区，物理不分区。</p><p>算法：三色标记 + SATB</p><h3 id="zgc1ms"><a class="anchor" href="#zgc1ms">#</a> ZGC(1ms)</h3><p>不分区，直接在内存上回收</p><p>算法：ColoredPointers + 写屏障</p><h3 id="shenandoah"><a class="anchor" href="#shenandoah">#</a> Shenandoah</h3><p>算法：ColoredPointers + 读屏障</p><h3 id="eplison"><a class="anchor" href="#eplison">#</a> Eplison</h3><h2 id="cms"><a class="anchor" href="#cms">#</a> CMS</h2><h3 id="cms的问题"><a class="anchor" href="#cms的问题">#</a> CMS 的问题</h3><ol><li><p>Memory Fragmentation：内存碎片化，因为 CMS 采用的垃圾回收算法是 Mark Sweep（标记清除算法），该算法的缺点就是会产生很多碎片化的内存</p><blockquote><p>-XX:+UseCMSCompactAtFullCollection<br>-XX:CMSFullGCsBeforeCompaction 默认为 0 指的是经过多少次 FGC 才进行压缩</p></blockquote></li><li><p>Floating Garbage：浮动垃圾，并发清理垃圾的同时会产生新的垃圾对象，等待下一次 CMS 解决，但如果有新生代区的对象要进入老年代区时，且老年代区若没有足够的内存容纳新生代区的对象时就会触发 Serial Old 垃圾回收器，而 Serial Old 是单线程清理垃圾且会停止当前所有工作线程直到垃圾清理完毕（STP），这样一来就会大幅度降低 CMS 本来的效率。所以，CMS 适合内存不大的情况下使用（一般最大为 20GB），因为老年代内存比较大的话，执行一次 FGC 会很耗时，何况 CMS 的回收算法（标记清理）会产生多的内存碎片，随后需要进行压缩内存碎片为连续内存。</p><blockquote><p>Concurrent Mode Failure<br>产生：if the concurrent collector is unable to finish reclaiming the unreachable objects before the tenured generation fills up, or if an allocation cannot be satisfiedwith the available free space blocks in the tenured generation, then theapplication is paused and the collection is completed with all the applicationthreads stopped</p><p>解决方案：降低触发 CMS 的阈值，使得剩余足够的空间让新生代升级（Promotion）以及有足够的空间存放浮动垃圾（等待下一次 CMS 回收）。即调整参数–XX:CMSInitiatingOccupancyFraction ，该参数默认为 68%，即老年代区的内存使用达到 68% 时就触发 FGC。但是如果内存很大的话，一味的降低该参数的值也是浪费内存。</p></blockquote></li><li><p>PromotionFailed：新生代对象升级到老年代对象失败，原因是，CMS 使用标记清除算法在老年代回收对象的过程中会产生很多碎片化的内存，当新生代对象试图进入老年代区时，发现内存都是碎片化的，导致无法存发新生代的对象，所以这些新生代区的对象就无法升级到老年代区</p><blockquote><p>解决方案类似，保持老年代有足够的空间</p><p>–XX:CMSInitiatingOccupancyFraction 可以降低这个值，让 CMS 保持老年代足够的空间</p></blockquote></li></ol><h3 id="并发标记算法"><a class="anchor" href="#并发标记算法">#</a> 并发标记算法</h3><p>CMS 的关键你是并发并发标记算法，CMS 采用了三色标记算法 + SATB 算法</p><p><img data-src="https://gitee.com/bfanfanfan/img/raw/master/docsify/image-20210315141852950.png" alt="image-20210315141852950"></p><h2 id="垃圾收集器和内存的关系"><a class="anchor" href="#垃圾收集器和内存的关系">#</a> 垃圾收集器和内存的关系</h2><ol><li>Serial - 几十兆</li><li>Parallel Scavenge 上百兆 - 几个 G</li><li>CMS - 20G</li><li>G1 - 上百 G</li><li>ZGC - 4T</li></ol><h2 id="常见垃圾回收器组合参数设定18"><a class="anchor" href="#常见垃圾回收器组合参数设定18">#</a> 常见垃圾回收器组合参数设定：(1.8)</h2><ul><li><p>-XX:+UseSerialGC = Serial New (DefNew) + Serial Old</p><ul><li>小型程序。默认情况下不会是这种选项，HotSpot 会根据计算及配置和 JDK 版本自动选择收集器</li></ul></li><li><p>-XX:+UseParNewGC = ParNew + SerialOld</p><ul><li>这个组合已经很少用（在某些版本中已经废弃）</li><li><span class="exturl" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzQ5NjIyNTcvd2h5LXJlbW92ZS1zdXBwb3J0LWZvci1wYXJuZXdzZXJpYWxvbGQtYW5kZGVmbmV3Y21zLWluLXRoZS1mdXR1cmU=">https://stackoverflow.com/questions/34962257/why-remove-support-for-parnewserialold-anddefnewcms-in-the-future</span></li></ul></li><li><p>-XX:+UseConc&lt;font color=red&gt;(urrent)&lt;/font&gt;MarkSweepGC = ParNew + CMS + Serial Old</p></li><li><p>-XX:+UseParallelGC = Parallel Scavenge + Parallel Old (1.8 默认) 【PS + SerialOld】</p></li><li><p>-XX:+UseParallelOldGC = Parallel Scavenge + Parallel Old</p></li><li><p>-XX:+UseG1GC = G1</p></li><li><p>Linux 中没找到默认 GC 的查看方法，而 windows 中会打印 UseParallelGC</p><ul><li>java +XX:+PrintCommandLineFlags -version</li><li>通过 GC 的日志来分辨</li></ul></li><li><p>Linux 下 1.8 版本默认的垃圾回收器到底是什么？</p><ul><li>1.8.0_181 默认（看不出来）Copy MarkCompact</li><li>1.8.0_222 默认 PS + PO</li></ul></li></ul><div class="tags"><a href="/tags/Java/" rel="tag"><i class="ic i-tag"></i> Java</a> <a href="/tags/JVM/" rel="tag"><i class="ic i-tag"></i> JVM</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2021-12-27 23:23:42" itemprop="dateModified" datetime="2021-12-27T23:23:42+08:00">2021-12-27</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.jpg" alt="fanfanfan 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.jpg" alt="fanfanfan 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>fanfanfan</li><li class="link"><strong>本文链接：</strong> <a href="https://baiyezi.vip/java/JVM/JVM-GC/" title="JVM-GC">https://baiyezi.vip/java/JVM/JVM-GC/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/java/JVM/JVM-JVM%E8%B0%83%E4%BC%98/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;gitee.com&#x2F;bfanfanfan&#x2F;img&#x2F;raw&#x2F;master&#x2F;yangchenglin&#x2F;20220220210604.png" title="JVM-JVM调优"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Java</span><h3>JVM-JVM调优</h3></a></div><div class="item right"><a href="/java/SpringCloud/SpringCloud-Alibaba%E4%BD%93%E7%B3%BB/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;gitee.com&#x2F;bfanfanfan&#x2F;img&#x2F;raw&#x2F;master&#x2F;yangchenglin&#x2F;20220220190137.png" title="SpringCloud-Alibaba体系"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 微服务</span><h3>SpringCloud-Alibaba体系</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#garbage-collector"><span class="toc-number">1.</span> <span class="toc-text">Garbage Collector</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jvm%E5%AF%BB%E6%89%BE%E5%9E%83%E5%9C%BE"><span class="toc-number">2.</span> <span class="toc-text">JVM 寻找垃圾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E7%94%A8%E8%AE%A1%E6%95%B0%E7%AE%97%E6%B3%95reference-count"><span class="toc-number">2.1.</span> <span class="toc-text">引用计数算法（reference count）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E5%8F%AF%E8%BE%BE%E6%80%A7%E7%AE%97%E6%B3%95root-searching"><span class="toc-number">2.2.</span> <span class="toc-text">根可达性算法（Root Searching）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gc%E5%B8%B8%E7%94%A8%E6%B8%85%E9%99%A4%E5%9E%83%E5%9C%BE%E7%AE%97%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">GC 常用清除垃圾算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E8%AE%B0%E6%B8%85%E9%99%A4%E7%AE%97%E6%B3%95mark-sweep"><span class="toc-number">3.1.</span> <span class="toc-text">标记清除算法（Mark-Sweep）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%B7%E8%B4%9D%E7%AE%97%E6%B3%95copying"><span class="toc-number">3.2.</span> <span class="toc-text">拷贝算法（Copying）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E8%AE%B0%E5%8E%8B%E7%BC%A9%E7%AE%97%E6%B3%95mark-compact"><span class="toc-number">3.3.</span> <span class="toc-text">标记压缩算法（Mark-Compact）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E4%BB%A3%E7%AE%97%E6%B3%95"><span class="toc-number">4.</span> <span class="toc-text">分代算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E5%86%85%E9%80%BB%E8%BE%91%E5%88%86%E5%8C%BA"><span class="toc-number">4.1.</span> <span class="toc-text">堆内逻辑分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E7%94%9F%E4%BB%A3young"><span class="toc-number">4.2.</span> <span class="toc-text">新生代（young）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E5%B9%B4%E4%BB%A3old"><span class="toc-number">4.3.</span> <span class="toc-text">老年代（old）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B0%B8%E4%B9%85%E4%BB%A3%E6%96%B9%E6%B3%95%E5%8C%BA"><span class="toc-number">4.4.</span> <span class="toc-text">永久代（方法区）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E4%BD%95%E6%97%B6%E8%BF%9B%E5%85%A5%E8%80%81%E5%B9%B4%E4%BB%A3"><span class="toc-number">4.5.</span> <span class="toc-text">对象何时进入老年代</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%85%8D%E6%8B%85%E4%BF%9D"><span class="toc-number">4.6.</span> <span class="toc-text">分配担保</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E4%B8%8A%E5%88%86%E9%85%8D%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.7.</span> <span class="toc-text">栈上分配对象</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E8%A2%AB%E5%88%86%E9%85%8D%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="toc-number">5.</span> <span class="toc-text">对象被分配的位置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8"><span class="toc-number">6.</span> <span class="toc-text">常见的垃圾回收器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#serial"><span class="toc-number">6.1.</span> <span class="toc-text">Serial</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#serial-old"><span class="toc-number">6.2.</span> <span class="toc-text">Serial Old</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#paraller-scavenge"><span class="toc-number">6.3.</span> <span class="toc-text">Paraller Scavenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parallel-old"><span class="toc-number">6.4.</span> <span class="toc-text">Parallel Old</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parnewparallel-new"><span class="toc-number">6.5.</span> <span class="toc-text">ParNew（Parallel New）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cmsconcurrent-mark-sweep"><span class="toc-number">6.6.</span> <span class="toc-text">CMS(Concurrent Mark Sweep)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#g110ms"><span class="toc-number">6.7.</span> <span class="toc-text">G1（10ms）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zgc1ms"><span class="toc-number">6.8.</span> <span class="toc-text">ZGC(1ms)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shenandoah"><span class="toc-number">6.9.</span> <span class="toc-text">Shenandoah</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eplison"><span class="toc-number">6.10.</span> <span class="toc-text">Eplison</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cms"><span class="toc-number">7.</span> <span class="toc-text">CMS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cms%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">7.1.</span> <span class="toc-text">CMS 的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E6%A0%87%E8%AE%B0%E7%AE%97%E6%B3%95"><span class="toc-number">7.2.</span> <span class="toc-text">并发标记算法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E5%92%8C%E5%86%85%E5%AD%98%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">8.</span> <span class="toc-text">垃圾收集器和内存的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8%E7%BB%84%E5%90%88%E5%8F%82%E6%95%B0%E8%AE%BE%E5%AE%9A18"><span class="toc-number">9.</span> <span class="toc-text">常见垃圾回收器组合参数设定：(1.8)</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/java/MySQL/Linux%E4%B8%8B%E5%AE%89%E8%A3%85MySQL/" rel="bookmark" title="Linux下安装MySQL">Linux下安装MySQL</a></li><li><a href="/java/MySQL/MySQL%E5%9F%BA%E7%A1%80/" rel="bookmark" title="MySQL基础">MySQL基础</a></li><li><a href="/java/Spring/IOC%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F%EF%BC%88%E4%B8%80%EF%BC%89/" rel="bookmark" title="IOC配置方式（一）">IOC配置方式（一）</a></li><li><a href="/java/Spring/IOC%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F%EF%BC%88%E4%BA%8C%EF%BC%89/" rel="bookmark" title="IOC配置方式（二）">IOC配置方式（二）</a></li><li><a href="/java/Spring/IOC%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F/" rel="bookmark" title="IOC注解方式">IOC注解方式</a></li><li><a href="/java/Spring/AOP/" rel="bookmark" title="AOP">AOP</a></li><li><a href="/java/SpringBoot/SpringBoot%E5%85%A5%E9%97%A8/" rel="bookmark" title="SpringBoot入门">SpringBoot入门</a></li><li><a href="/java/SpringBoot/SpringBoot-Web%E5%BC%80%E5%8F%91/" rel="bookmark" title="SpringBoot-Web开发">SpringBoot-Web开发</a></li><li><a href="/java/SpringBoot/SpringBoot%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%E5%8E%9F%E7%90%86/" rel="bookmark" title="SpringBoot自动装配原理">SpringBoot自动装配原理</a></li><li><a href="/java/zookeeper/zookeeper%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" rel="bookmark" title="zookeeper搭建及基本概念">zookeeper搭建及基本概念</a></li><li><a href="/java/zookeeper/zookeeper%E5%8E%9F%E7%90%86/" rel="bookmark" title="zookeeper原理">zookeeper原理</a></li><li><a href="/java/zookeeper/zookeeper%E6%A1%88%E4%BE%8B/" rel="bookmark" title="zookeeper案例">zookeeper案例</a></li><li><a href="/java/MySQL/MySQL%E8%B0%83%E4%BC%98%EF%BC%88%E4%B8%80%EF%BC%89/" rel="bookmark" title="MySQL调优（一）">MySQL调优（一）</a></li><li><a href="/java/redis/redis%E5%AE%89%E8%A3%85%E5%8F%8ANIO%E5%8E%9F%E7%90%86/" rel="bookmark" title="redis安装及NIO原理">redis安装及NIO原理</a></li><li><a href="/java/SpringMVC/SpringMVC%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%80%EF%BC%89/" rel="bookmark" title="SpringMVC入门（一）">SpringMVC入门（一）</a></li><li><a href="/java/SpringMVC/SpringMVC%E5%85%A5%E9%97%A8%EF%BC%88%E4%BA%8C%EF%BC%89/" rel="bookmark" title="SpringMVC入门（二）">SpringMVC入门（二）</a></li><li><a href="/java/SpringMVC/SpringMVC-REST%E9%A3%8E%E6%A0%BC/" rel="bookmark" title="SpringMVC-REST风格">SpringMVC-REST风格</a></li><li><a href="/java/SpringMVC/SpringMVC%E8%BF%9B%E9%98%B6/" rel="bookmark" title="SpringMVC进阶">SpringMVC进阶</a></li><li><a href="/java/SpringMVC/SpringMVC%E6%BA%90%E7%A0%81%E6%80%BB%E7%BB%93/" rel="bookmark" title="SpringMVC源码总结">SpringMVC源码总结</a></li><li><a href="/java/shiro/shiro%E5%85%A5%E9%97%A8/" rel="bookmark" title="shiro入门">shiro入门</a></li><li><a href="/java/shiro/shiro%E6%95%B4%E5%90%88SpringBoot/" rel="bookmark" title="shiro整合SpringBoot">shiro整合SpringBoot</a></li><li><a href="/java/shiro/shiro%E7%9A%84session%E7%AE%A1%E7%90%86/" rel="bookmark" title="shiro的session管理">shiro的session管理</a></li><li><a href="/java/shiro/shiro%E7%9A%84%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6%E4%B8%8E%E5%88%86%E5%B8%83%E5%BC%8F%E7%99%BB%E5%BD%95/" rel="bookmark" title="shiro的缓存机制与分布式登录">shiro的缓存机制与分布式登录</a></li><li><a href="/java/shiro/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/" rel="bookmark" title="单点登录">单点登录</a></li><li><a href="/java/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" rel="bookmark" title="线程基础知识">线程基础知识</a></li><li><a href="/java/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/%E5%AE%B9%E5%99%A8%E4%B8%8E%E7%BA%BF%E7%A8%8B%E6%B1%A0/" rel="bookmark" title="容器与线程池">容器与线程池</a></li><li><a href="/java/docker/Win10%E5%AE%89%E8%A3%85docker/" rel="bookmark" title="Win10安装docker">Win10安装docker</a></li><li><a href="/java/docker/Win10%E4%B8%ADdocker%E9%83%A8%E7%BD%B2springboot%E9%A1%B9%E7%9B%AE/" rel="bookmark" title="Win10安装docker">Win10安装docker</a></li><li><a href="/java/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/JMH/" rel="bookmark" title="JMH">JMH</a></li><li><a href="/java/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" rel="bookmark" title="并发编程">并发编程</a></li><li><a href="/java/%E6%97%A5%E5%BF%97/java-%E6%97%A5%E5%BF%97%E4%BD%93%E7%B3%BB/" rel="bookmark" title="java-日志体系">java-日志体系</a></li><li><a href="/java/redis/redis%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" rel="bookmark" title="redis的数据类型">redis的数据类型</a></li><li><a href="/java/redis/redis%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8/" rel="bookmark" title="redis进阶使用">redis进阶使用</a></li><li><a href="/java/redis/redis%E7%9A%84%E9%9B%86%E7%BE%A4/" rel="bookmark" title="redis的集群">redis的集群</a></li><li><a href="/java/redis/redis%E5%9C%A8%E5%BC%80%E5%8F%91%E4%B8%AD%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/" rel="bookmark" title="redis在开发中的简单使用">redis在开发中的简单使用</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/ChainOfResponsibility%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="ChainOfResponsibility责任链模式">ChainOfResponsibility责任链模式</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Composite%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="Composite组合模式">Composite组合模式</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Flyweight%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="Flyweight享元模式">Flyweight享元模式</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Mediator%E8%B0%83%E5%81%9C%E8%80%85%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="Mediator调停者模式">Mediator调停者模式</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Iterator%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="Iterator迭代器模式">Iterator迭代器模式</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Observer%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="Observer观察者模式">Observer观察者模式</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Proxy%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="Proxy代理模式">Proxy代理模式</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Singleton%E5%8D%95%E4%BE%8B/" rel="bookmark" title="Singleton单例">Singleton单例</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Decorator%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="Decorator装饰器模式">Decorator装饰器模式</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Facade%E9%97%A8%E9%9D%A2%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="Facade门面模式">Facade门面模式</a></li><li><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Factory%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="Factory工厂模式">Factory工厂模式</a></li><li><a href="/java/SpringCloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%BB%A5%E5%8F%8A%E6%9E%B6%E6%9E%84%E5%8F%91%E5%B1%95/" rel="bookmark" title="微服务以及架构发展">微服务以及架构发展</a></li><li><a href="/java/JVM/JVM-%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD/" rel="bookmark" title="JVM-类的加载">JVM-类的加载</a></li><li><a href="/java/SpringCloud/SpringCloud-Netflix%E4%BD%93%E7%B3%BB/" rel="bookmark" title="SpringCloud-Netflix体系">SpringCloud-Netflix体系</a></li><li><a href="/java/%E5%BA%8F%E5%88%97%E5%8C%96/%E5%BA%8F%E5%88%97%E5%8C%96/" rel="bookmark" title="序列化">序列化</a></li><li><a href="/java/JVM/JVM-JMM/" rel="bookmark" title="JVM-JMM">JVM-JMM</a></li><li><a href="/java/%E4%BA%BF%E7%BA%A7%E6%B5%81%E9%87%8F%E5%A4%9A%E7%BA%A7%E7%BC%93%E5%AD%98/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/" rel="bookmark" title="分布式系统与高并发系统架构">分布式系统与高并发系统架构</a></li><li><a href="/java/JVM/JVM-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA/" rel="bookmark" title="JVM-对象的创建">JVM-对象的创建</a></li><li><a href="/java/JVM/JVM-JVM%E8%B0%83%E4%BC%98/" rel="bookmark" title="JVM-JVM调优">JVM-JVM调优</a></li><li class="active"><a href="/java/JVM/JVM-GC/" rel="bookmark" title="JVM-GC">JVM-GC</a></li><li><a href="/java/SpringCloud/SpringCloud-Alibaba%E4%BD%93%E7%B3%BB/" rel="bookmark" title="SpringCloud-Alibaba体系">SpringCloud-Alibaba体系</a></li><li><a href="/java/SpringCloud/SpringCloud-SpringCloud%E4%BD%93%E7%B3%BB/" rel="bookmark" title="SpringCloud-SpringCloud体系">SpringCloud-SpringCloud体系</a></li><li><a href="/java/SpringCloud/Apollo/" rel="bookmark" title="Apollo">Apollo</a></li><li><a href="/java/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%BC%9A%E8%AF%9D/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%AD%E7%9A%84%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86%EF%BC%88%E4%B8%80%EF%BC%89/" rel="bookmark" title="微服务中的会话管理（一）">微服务中的会话管理（一）</a></li><li><a href="/java/io/%E7%A3%81%E7%9B%98IO%E4%B8%8E%E7%BD%91%E7%BB%9CIO/" rel="bookmark" title="磁盘IO与网络IO">磁盘IO与网络IO</a></li><li><a href="/java/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%BC%9A%E8%AF%9D/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%AD%E7%9A%84%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86%EF%BC%88%E4%BA%8C%EF%BC%89/" rel="bookmark" title="微服务中的会话管理（二）">微服务中的会话管理（二）</a></li><li><a href="/java/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%BC%9A%E8%AF%9D/HTTPS/" rel="bookmark" title="HTTPS">HTTPS</a></li><li><a href="/java/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ/RocketMQ-%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" rel="bookmark" title="RocketMQ-基础概念">RocketMQ-基础概念</a></li><li><a href="/java/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ/RocketMQ-%E6%B6%88%E6%81%AF%E3%80%81%E4%BA%8B%E5%8A%A1/" rel="bookmark" title="RocketMQ-消息、事务">RocketMQ-消息、事务</a></li><li><a href="/java/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/Kafka-%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84/" rel="bookmark" title="Kafka-整体架构">Kafka-整体架构</a></li><li><a href="/java/io/%E7%BD%91%E7%BB%9CIO%E6%A8%A1%E5%9E%8B/" rel="bookmark" title="网络IO模型">网络IO模型</a></li><li><a href="/java/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/Kafka-%E6%90%AD%E5%BB%BA/" rel="bookmark" title="Kafka-搭建">Kafka-搭建</a></li><li><a href="/java/io/Netty/" rel="bookmark" title="Netty">Netty</a></li><li><a href="/java/Nginx/nginx%E5%AE%9E%E6%88%98/" rel="bookmark" title="nginx实战">nginx实战</a></li><li><a href="/instruments/%E4%B8%B2%E5%8F%A3/Java%E5%92%8C%E4%B8%B2%E5%8F%A3%E8%BF%9B%E8%A1%8C%E9%80%9A%E4%BF%A1/" rel="bookmark" title="Java和串口进行通信">Java和串口进行通信</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="fanfanfan" data-src="/images/avatar.gif"><p class="name" itemprop="name">fanfanfan</p><div class="description" itemprop="description">花有重开日，人无再少年</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">76</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">78</span> <span class="name">标签</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-magic"></i>友链</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item"><a href="/statistics/" rel="section"><i class="ic i-heart"></i>文章统计</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/java/JVM/JVM-JVM%E8%B0%83%E4%BC%98/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/java/SpringCloud/SpringCloud-Alibaba%E4%BD%93%E7%B3%BB/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/java/" title="分类于 Java">Java</a></div><span><a href="/java/Spring/AOP/" title="AOP">AOP</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java/" title="分类于 Java">Java</a></div><span><a href="/java/Spring/IOC%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F/" title="IOC注解方式">IOC注解方式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/front/" title="分类于 前端">前端</a></div><span><a href="/front/%E7%AE%80%E5%8D%95%E5%9B%BE%E8%A1%A8%E5%88%B6%E4%BD%9C/%E5%9B%BE%E8%A1%A8%EF%BC%88%E4%B8%89%EF%BC%89/" title="图表（三）">图表（三）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java/" title="分类于 Java">Java</a></div><span><a href="/java/SpringMVC/SpringMVC%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%80%EF%BC%89/" title="SpringMVC入门（一）">SpringMVC入门（一）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java/" title="分类于 Java">Java</a></div><span><a href="/java/redis/redis%E5%AE%89%E8%A3%85%E5%8F%8ANIO%E5%8E%9F%E7%90%86/" title="redis安装及NIO原理">redis安装及NIO原理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java/" title="分类于 Java">Java</a></div><span><a href="/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Singleton%E5%8D%95%E4%BE%8B/" title="Singleton单例">Singleton单例</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java/" title="分类于 Java">Java</a></div><span><a href="/java/MySQL/MySQL%E5%9F%BA%E7%A1%80/" title="MySQL基础">MySQL基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java/" title="分类于 Java">Java</a></div><span><a href="/java/Nginx/nginx%E5%AE%9E%E6%88%98/" title="nginx实战">nginx实战</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/instruments/" title="分类于 工具">工具</a></div><span><a href="/instruments/%E6%B5%81%E7%A8%8B%E5%9B%BE/%E5%9F%BA%E4%BA%8ETypora%E7%9A%84%E6%B5%81%E7%A8%8B%E5%9B%BE%E5%88%B6%E4%BD%9C/" title="基于Typora的流程图制作">基于Typora的流程图制作</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java/" title="分类于 Java">Java</a></div><span><a href="/java/%E5%BA%8F%E5%88%97%E5%8C%96/%E5%BA%8F%E5%88%97%E5%8C%96/" title="序列化">序列化</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">fanfanfan</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">1.4m 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">20:37</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"java/JVM/JVM-GC/",favicon:{show:"书院十四先生",hide:"书院十四先生"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js,npm/echarts@5.2.2/dist/echarts.min.js"></script><script src="/js/app.js?v=0.2.5"></script><script data-pjax>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?163b363f1983d176d657221fc8e1631b";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></body></html><!-- rebuild by hrmmi -->